@{
    ViewBag.Title = "Contact";
}


<!-- Contact Start -->
<div class="container">
    <div class="row">
        <div class="col-md-4 targeta-contact">
            <div class="contact-info">
                <img style="padding-left: 40%" src="https://image.ibb.co/kUASdV/contact-image.png" alt="image" />
                <h2 class="text-uppercase secondary-font-bold text-center" style="letter-spacing: 5px;">
                    Contáctenos
                </h2>
                <h4 class=" text-center">¡Nos Encantaría Saber de Usted!</h4>
            </div>
        </div>
        <div class="col-md-8 trg-cont-2">
            <form class="contact-form ">
                <div class="form-group">
                    <label class="control-label col-sm-2" for="fname">Nombre(s):</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="txtNombre" placeholder="Escriba su nombre" name="fname" required pattern="[A-Za-zÁÉÍÓÚáéíóú\s]+" title="El formato debe ser de solo letras" maxlength="160">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="apellidos">Apellidos:</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="txtApellidos" placeholder="Escriba sus apellidos" name="apellidos" required pattern="[A-Za-zÁÉÍÓÚáéíóú\s]+" title="El formato debe ser de solo letras" maxlength="120">
                        <div class="invalid-feedback">
                            Debe ingresar sus apellidos
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="email">Correo electronico:</label>
                    <div class="col-sm-10">
                        <input type="email" class="form-control" id="txtEmail" placeholder="Escriba su correo electronico" name="email" required pattern="[a-zA-Z0-9._%+-]+\u0040[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}" title="El formato debe ser de example@mail.com" maxlength="120">

                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="tel">Telefono:</label>
                    <div class="col-sm-10">
                        <input type="tel" class="form-control" id="txtTelefono" placeholder="Escriba su numero telefonico" name="telefono" required pattern="[0-9]{10}" title="El número de teléfono debe tener exactamente 10 dígitos">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label col-sm-2" for="cboAsunto">Asunto:</label>
                    <div class="col-sm-10">
                        <select id="cboAsunto" class="form-select form-control" required>
                            <option selected>Seleccione un Asunto</option>
                            <option value="1">Lavado Sencillo</option>
                            <option value="2">Lavado Especial</option>
                            <option value="3">Lavado Premier</option>
                            <option value="4">Reparación Provicional</option>
                            <option value="5">Otro Asunto</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-sm-2" for="comment">Mensaje:</label>
                    <div class="col-sm-10">
                        <textarea class="form-control" rows="5" id="txtmensaje" maxlength="400" required></textarea>
                    </div>
                </div>

                <div id="mensajeConfirmacion" class="alert alert-success form-group" style="display: none;"></div>

                <div class="form-group text-center">
                    <div class="col-sm-offset-2 col-sm-10 pt-3">
                        <button type="submit" class="btn btn-default">Enviar</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- Contact End -->


@section scripts{

    <script src="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@2.1.7/dist/loadingoverlay.min.js"></script>

    <script>

        $(document).ready(function () {
            // Agregar el controlador del evento submit al formulario
            $("form.contact-form").submit(function (event) {
                event.preventDefault(); // Evitar que el formulario se envíe automáticamente

                // Llamar a la función Guardar para manejar el envío del formulario
                Guardar();
            });
        });

        function Guardar() {

            var ContactoAsesores = {
                    Nombre: $("#txtNombre").val(),
                 Apellidos: $("#txtApellidos").val(),
                    Asunto: { AsuntoID: $("#cboAsunto").val() },
                  Telefono: $("#txtTelefono").val(),
                    Correo: $("#txtEmail").val(),
                   Mensaje: $("#txtmensaje").val(),
            }

            jQuery.ajax({
                url: '@Url.Action("GuardarSolicitudAsesor", "Home")',
                type: "POST",
                data: JSON.stringify({ objeto: ContactoAsesores }),
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    if (data.resultado != 0) {
                        $('#mensajeConfirmacion').text(data.Mensaje);
                        $('#mensajeConfirmacion').show();
                        $('form.contact-form')[0].reset(); // Limpiar el formulario después del registro exitoso
                    } else {
                        alert(data.Mensaje);
                    }
                },
                error: function (error) {
                    $("form.contact-form").LoadingOverlay("hide");
                    console.log(error)
                    alert("Hubo un error en su solicitud, vueva a intentar. Si el problema persiste porfavor, envienos un correo, Gracias! ");
                },
                beforeSend: function () {
                    $("form.contact-form").LoadingOverlay("show", {
                        imageResizeFactor: 2,
                        text: "Procesando...",
                        size: 14
                    });
                },
                complete: function () {
                    $("form.contact-form").LoadingOverlay("hide");
                    alert("Su mensaje se envio correctamente, gracias por comunicarse con nosostros. \n\n Atte: Equipo Galpermex.");
                }
            });
        }
    </script>

}

